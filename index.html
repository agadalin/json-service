<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="JSON Service : JSON-RPC library for Java" />
    <title>JSON Service - JSON-RPC library for Java</title>
    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/shCoreEclipse.css">
    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/shThemeEclipse.css">
    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/main.css">
    <script type="text/javascript" src="javascripts/jquery-1.8.0.min.js"></script>
    <script type="text/javascript" src="javascripts/shCore.js"></script>
    <script type="text/javascript" src="javascripts/shBrushJava.js"></script>
    <script type="text/javascript" src="javascripts/shBrushJScript.js"></script>
    <script type="text/javascript" src="javascripts/shBrushXml.js"></script>
    <script type="text/javascript" src="javascripts/main.js"></script>
</head>
<body>

    <!-- header -->
    <div id="header_wrap" class="outer">
        <header class="inner">
            <a id="forkme_banner" href="https://github.com/stefaniuk/json-service">View on GitHub</a>
            <h1 id="project_title">JSON Service</h1>
            <h2 id="project_tagline">JSON-RPC library for Java</h2>
            <section id="downloads">
                <a class="zip_download_link" href="https://github.com/stefaniuk/json-service/zipball/master">Download this project as a .zip file</a>
                <a class="tar_download_link" href="https://github.com/stefaniuk/json-service/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- main content -->
    <div id="main_content_wrap" class="outer">
        <section id="main_content" class="inner">

            <h2>What is JSON-RPC?</h2>
            <p>TODO</p>

            <h2>Overview</h2>
            <p>TODO</p>

            <h2>Features</h2>
            <p>TODO</p>

            <h2>Examples</h2>

            <h3>Example 1: Java Servlet</h3>

            <p>Download <a href="https://github.com/stefaniuk/json-service/raw/master/build/json-service-example1.war">json-service-example1.war</a></p>

            <span class="file-name">CalculatorService.java</span>
            <pre class="brush: java; highlight: [3]; collapse: true">
                public class CalculatorService {

                    @JsonService
                    public Integer add(Integer v1, Integer v2) {

                        return v1 + v2;
                    }

                    @JsonService
                    public Integer subtract(Integer v1, Integer v2) {

                        return v1 - v2;
                    }

                    @JsonService
                    public Integer multiple(Integer v1, Integer v2) {

                        return v1 * v2;
                    }

                    @JsonService
                    public Integer divide(Integer v1, Integer v2) {

                        return v1 / v2;
                    }

                }
            </pre>

            <span class="file-name">JsonRpcController.java</span>
            <pre class="brush: java; highlight: [3,6,15,30]; collapse: true">
                public class JsonRpcController extends HttpServlet {

                    private static JsonServiceRegistry service = new JsonServiceRegistry();

                    static {
                        service.register(CalculatorService.class);
                    }

                    @Override
                    public void doGet(HttpServletRequest request, HttpServletResponse response) {

                        response.setCharacterEncoding("UTF-8");
                        response.setContentType("application/json");

                        service.getServiceMap(CalculatorService.class, response);
                        response.setStatus(200);
                    }

                    @Override
                    public void doPost(HttpServletRequest request, HttpServletResponse response) {

                        String date = (new SimpleDateFormat("EEE, dd MMM yyyy HH:mm:ss z")).format(Calendar.getInstance().getTime());

                        response.setCharacterEncoding("UTF-8");
                        response.setContentType("application/json");
                        response.setHeader("Expires", "Mon, 01 Jan 2000 00:00:00 GMT");
                        response.setHeader("Last-Modified", date);
                        response.setHeader("Cache-Control", "no-cache");

                        service.handle(request, response, CalculatorService.class);
                        response.setStatus(200);
                    }

                }
            </pre>

            <span class="file-name">web.xml</span>
            <pre class="brush: xml; collapse: true">
                &lt;servlet&gt;
                    &lt;display-name&gt;servlet&lt;/display-name&gt;
                    &lt;servlet-name&gt;servlet&lt;/servlet-name&gt;
                    &lt;servlet-class&gt;org.stefaniuk.json.service.example1.JsonRpcController&lt;/servlet-class&gt;
                &lt;/servlet&gt;

                &lt;servlet-mapping&gt;
                    &lt;servlet-name&gt;servlet&lt;/servlet-name&gt;
                    &lt;url-pattern&gt;/jsonrpc&lt;/url-pattern&gt;
                &lt;/servlet-mapping&gt;
            </pre>

            <span class="file-name">index.jsp</span>
            <pre class="brush: javascript; highlight: [9]; collapse: true">
                require([
                    'dojo/ready',
                    'dojox/rpc/Service',
                    'dojox/rpc/JsonRPC' // JsonRPC has to be loaded too
                ], function(ready, Service) {
                    ready(function() {

                        // create JSON-RPC service
                        service = new Service('jsonrpc');

                        // call JSON-RPC methods
                        service.add(12345, 54321).then(function(result) {
                            console.log('(add)', result);
                        });
                        service.subtract(12345, 54321).then(function(result) {
                            console.log('(subtract)', result);
                        });
                        service.multiple(12345, 54321).then(function(result) {
                            console.log('(multiple)', result);
                        });
                        service.divide(12345, 54321).then(function(result) {
                            console.log('(divide)', result);
                        });

                    });

                });
            </pre>

            <h3>Example 2: Simple Spring Framework integration</h3>

            <p>Download <a href="https://github.com/stefaniuk/json-service/raw/master/build/json-service-example2.war">json-service-example2.war</a></p>

            <span class="file-name">CalculatorService.java</span>
            <pre class="brush: java; collapse: true">
                public class CalculatorService {

                    @JsonService
                    public Integer add(Integer v1, Integer v2) {

                        return v1 + v2;
                    }

                    @JsonService
                    public Integer subtract(Integer v1, Integer v2) {

                        return v1 - v2;
                    }

                    @JsonService
                    public Integer multiple(Integer v1, Integer v2) {

                        return v1 * v2;
                    }

                    @JsonService
                    public Integer divide(Integer v1, Integer v2) {

                        return v1 / v2;
                    }

                }
            </pre>

            <span class="file-name">JsonRpcController.java</span>
            <pre class="brush: java; highlight: [11]; collapse: true">
                @Controller
                @RequestMapping(value = &quot;/jsonrpc/*&quot;)
                public class JsonRpcController {

                    @Autowired
                    private JsonServiceRegistry jsonService;

                    @RequestMapping(value = &quot;*&quot;)
                    public ResponseEntity&lt;String&gt; service(HttpServletRequest request, HttpServletResponse response) throws Exception {

                        return JsonServiceUtil.handle(jsonService, request, response, CalculatorService.class);
                    }

                }
            </pre>

            <span class="file-name">service.xml</span>
            <pre class="brush: xml; highlight: [8]; collapse: true">
                &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
                &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;
                    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
                    xsi:schemaLocation=&quot;
                        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd&quot;&gt;

                    &lt;!-- JSON Service (JSON-RPC) --&gt;
                    &lt;bean id=&quot;jsonService&quot; class=&quot;org.stefaniuk.json.service.JsonServiceRegistry&quot;&gt;
                        &lt;property name=&quot;registry&quot;&gt;
                            &lt;list&gt;
                                &lt;value&gt;org.stefaniuk.json.service.example2.CalculatorService&lt;/value&gt;
                            &lt;/list&gt;
                        &lt;/property&gt;
                    &lt;/bean&gt;

                &lt;/beans&gt;
            </pre>

            <span class="file-name">index.jsp</span>
            <pre class="brush: javascript; collapse: true">
                require([
                    'dojo/ready',
                    'dojox/rpc/Service',
                    'dojox/rpc/JsonRPC' // JsonRPC has to be loaded too
                ], function(ready, Service) {
                    ready(function() {

                        // create JSON-RPC service
                        service = new Service('controller/jsonrpc/');

                        // call JSON-RPC methods
                        service.add(12345, 54321).then(function(result) {
                            console.log('(add)', result);
                        });
                        service.subtract(12345, 54321).then(function(result) {
                            console.log('(subtract)', result);
                        });
                        service.multiple(12345, 54321).then(function(result) {
                            console.log('(multiple)', result);
                        });
                        service.divide(12345, 54321).then(function(result) {
                            console.log('(divide)', result);
                        });

                    });

                });
            </pre>

            <h3>Example 3: Advanced Spring Framework integration</h3>

            <p>Download <a href="https://github.com/stefaniuk/json-service/raw/master/build/json-service-example3.war">json-service-example3.war</a></p>

            <span class="file-name">Album.java</span>
            <pre class="brush: java; highlight: [20]; collapse: true">
                @ModelTable(name = &quot;Album&quot;)
                public class Album extends AbstractModel {

                    @ModelColumn(name = &quot;AlbumId&quot;)
                    private Integer id;

                    @ModelColumn(name = &quot;Title&quot;)
                    private String title;

                    @ModelColumn(name = &quot;ArtistId&quot;)
                    private Integer artistId;

                    public Album(Integer id, String title, Integer artistId) {

                        this.id = id;
                        this.title = title;
                        this.artistId = artistId;
                    }

                    public Album(Map&lt;String, Object&gt; row) {

                        setId((Integer) row.get(getColumnName(this.getClass(), &quot;id&quot;)));
                        setTitle((String) row.get(getColumnName(this.getClass(), &quot;title&quot;)));
                        setArtistId((Integer) row.get(getColumnName(this.getClass(), &quot;artistId&quot;)));
                    }

                    public Integer getId() {

                        return id;
                    }

                    public void setId(Integer id) {

                        this.id = id;
                    }

                    public String getTitle() {

                        return title;
                    }

                    public void setTitle(String title) {

                        this.title = title;
                    }

                    public Integer getArtistId() {

                        return artistId;
                    }

                    public void setArtistId(Integer artistId) {

                        this.artistId = artistId;
                    }

                }
            </pre>

            <span class="file-name">AlbumDao.java</span>
            <pre class="brush: java; highlight: [33, 40]; collapse: true">
                public class AlbumDao extends AbstractModelDao&lt;Album&gt; {

                    @Override
                    public Integer create(Album model) {

                        return null;
                    }

                    @Override
                    public Integer update(Album model) {

                        return null;
                    }

                    @Override
                    public Integer update(Album model, Album changed) {

                        return null;
                    }

                    @Override
                    public Integer remove(Album model) {

                        return null;
                    }

                    @Override
                    public List&lt;Album&gt; findAll() {

                        return null;
                    }

                    public List&lt;Album&gt; findByArtistId(Integer artistId) {

                        List&lt;Album&gt; list = new ArrayList&lt;Album&gt;();

                        String sql = String.format(&quot;select * from %1$s where ArtistId = &quot; + artistId, TABLE_NAME);
                        List&lt;Map&lt;String, Object&gt;&gt; rows = getJdbcTemplate().queryForList(sql);
                        for(Map&lt;String, Object&gt; row: rows) {
                            list.add(new Album(row));
                        }

                        return list;
                    }

                    @Override
                    public Album findById(Integer id) {

                        return null;
                    }

                    @Override
                    public Integer findIdByModel(Album model) {

                        return null;
                    }

                    @Override
                    public Integer countAll() {

                        return null;
                    }

                }
            </pre>

            <span class="file-name">AlbumService.java</span>
            <pre class="brush: java; highlight: [6]; collapse: true">
                public class AlbumService extends AbstractService&lt;AlbumDao&gt; {

                    @JsonService
                    public List&lt;Album&gt; list(Integer artistId) {

                        return dao.findByArtistId(artistId);
                    }
                }
            </pre>

            <span class="file-name">ChinookController.java</span>
            <pre class="brush: java; highlight: [16]; collapse: true">
                @Controller
                @RequestMapping(value = &quot;/chinook/*&quot;)
                public class ChinookController extends AbstractController {

                    @Override
                    @RequestMapping(&quot;service/{service}&quot;)
                    public ResponseEntity&lt;String&gt; service(HttpServletRequest request, HttpServletResponse response,
                            @PathVariable String service) throws Exception {

                        ResponseEntity&lt;String&gt; re = null;

                        if(service.equals(&quot;artist&quot;)) {
                            re = handleJsonRpc(request, response, ArtistService.class);
                        }
                        else if(service.equals(&quot;album&quot;)) {
                            re = handleJsonRpc(request, response, AlbumService.class);
                        }
                        else if(service.equals(&quot;track&quot;)) {
                            re = handleJsonRpc(request, response, TrackService.class);
                        }

                        return re;
                    }

                }
            </pre>

            <span class="file-name">service.xml</span>
            <pre class="brush: xml; highlight: [10]; collapse: true">
                &lt;!-- JSON Service (JSON-RPC) --&gt;
                &lt;bean id=&quot;jsonService&quot; class=&quot;org.stefaniuk.json.service.JsonServiceRegistry&quot; /&gt;

                &lt;!-- artistService --&gt;
                &lt;bean id=&quot;artistService&quot; class=&quot;org.stefaniuk.json.service.example3.service.ArtistService&quot;&gt;
                    &lt;property name=&quot;service&quot; ref=&quot;jsonService&quot; /&gt;
                &lt;/bean&gt;

                &lt;!-- albumService --&gt;
                &lt;bean id=&quot;albumService&quot; class=&quot;org.stefaniuk.json.service.example3.service.AlbumService&quot;&gt;
                    &lt;property name=&quot;service&quot; ref=&quot;jsonService&quot; /&gt;
                &lt;/bean&gt;

                &lt;!-- trackService --&gt;
                &lt;bean id=&quot;trackService&quot; class=&quot;org.stefaniuk.json.service.example3.service.TrackService&quot;&gt;
                    &lt;property name=&quot;service&quot; ref=&quot;jsonService&quot; /&gt;
                &lt;/bean&gt;
            </pre>

            <span class="file-name">persistence.xml</span>
            <pre class="brush: xml; highlight: [12]; collapse: true">
                &lt;!-- chinook.sqlite --&gt;
                &lt;bean id=&quot;sqliteFileDataSource&quot; class=&quot;org.stefaniuk.json.service.example3.datasource.SQLiteFileDataSource&quot; scope=&quot;globalSession&quot;&gt;
                    &lt;aop:scoped-proxy proxy-target-class=&quot;false&quot; /&gt;
                &lt;/bean&gt;

                &lt;!-- artistDao --&gt;
                &lt;bean id=&quot;artistDao&quot; class=&quot;org.stefaniuk.json.service.example3.model.ArtistDao&quot;&gt;
                    &lt;property name=&quot;dataSource&quot; ref=&quot;sqliteFileDataSource&quot; /&gt;
                &lt;/bean&gt;

                &lt;!-- albumDao --&gt;
                &lt;bean id=&quot;albumDao&quot; class=&quot;org.stefaniuk.json.service.example3.model.AlbumDao&quot;&gt;
                    &lt;property name=&quot;dataSource&quot; ref=&quot;sqliteFileDataSource&quot; /&gt;
                &lt;/bean&gt;

                &lt;!-- trackDao --&gt;
                &lt;bean id=&quot;trackDao&quot; class=&quot;org.stefaniuk.json.service.example3.model.TrackDao&quot;&gt;
                    &lt;property name=&quot;dataSource&quot; ref=&quot;sqliteFileDataSource&quot; /&gt;
                &lt;/bean&gt;
            </pre>

            <span class="file-name">index.jsp</span>
            <pre class="brush: javascript; collapse: true">
                require([
                    'dojo/ready',
                    'dojox/rpc/Service',
                    'dojox/rpc/JsonRPC' // JsonRPC has to be loaded too
                ], function(ready, Service) {
                    ready(function() {

                        // create JSON-RPC services
                        var artistService = new Service('chinook/service/artist');
                        var albumService = new Service('chinook/service/album');
                        var trackService = new Service('chinook/service/track');

                        var count = 1;
                        var artistId = 87;
                        artistService.list().then(function(artists) {
                            albumService.list(artists[artistId].id).then(function(albums) {
                                for(var i in albums) {
                                    var album = albums[i];
                                    (function(album) { // this closure is requried to save a reference to the current album
                                        trackService.list(album.id).then(function(tracks) {
                                            for(var j in tracks) {
                                                var track = tracks[j];
                                                console.log(
                                                    count++, ' - ',
                                                    artists[artistId].name, ' - ',
                                                    album.title, ' - ',
                                                    track.name
                                                );
                                            }
                                        });
                                    })(album); // end: closure
                                }
                            });
                        });

                    });

                });
            </pre>

            <h3>Example 4: Spring Framework, Hibernate and Dojo Store</h3>
            <p>TODO</p>

            <h2>Download</h2>

            <a href="https://github.com/stefaniuk/json-service/raw/master/build/json-service-1.1.0.jar">json-service-1.1.0.jar</a>
            <br />
            <a href="https://github.com/stefaniuk/json-service/raw/master/build/json-service-1.1.0-sources.jar">json-service-1.1.0-sources.jar</a>
            <br />
            <a href="https://github.com/stefaniuk/json-service/raw/master/build/json-service-1.1.0-javadoc.jar">json-service-1.1.0-javadoc.jar</a>
            <br />
            <a href="https://github.com/stefaniuk/json-service/raw/master/build/json-service-example1.war">json-service-example1.war</a>
            <br />
            <a href="https://github.com/stefaniuk/json-service/raw/master/build/json-service-example2.war">json-service-example2.war</a>
            <br />
            <a href="https://github.com/stefaniuk/json-service/raw/master/build/json-service-example3.war">json-service-example3.war</a>

        </section>
    </div>

    <!-- footer -->
    <div id="footer_wrap" class="outer">
        <footer class="inner">
            <p class="copyright">JSON Service maintained by <a href="https://github.com/stefaniuk">stefaniuk</a></p>
            <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
        </footer>
    </div>

    <!-- SyntaxHighlighter -->
    <script type="text/javascript">
        SyntaxHighlighter.all();
    </script>

</body>
</html>
