<!doctype html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Test</title>
    <style type="text/css">
        @import "../../dojo/resources/dojo.css";
        @import "../../dijit/themes/claro/claro.css";
        @import "../../dojox/grid/resources/Grid.css";
        @import "../../dojox/grid/resources/claroGrid.css";
        @import "../../nhs/themes/nhs/nhs.css";
    </style>
    <script type="text/javascript" src="../../dojo/dojo.js" data-dojo-config="async: 0, parseOnLoad: true, locale: 'en'"></script>
    <script type="text/javascript">
        require([
            'dojo/ready',
            'nhs/main',
            'nhs/data/JsonRpcStore',
            'nhs/grid/DataGrid',
            //'dijit/tree/ForestStoreModel',
            //'dojox/grid/LazyTreeGrid'
            'nhs/BorderContainer',
            'dijit/layout/ContentPane'
        ], function(ready, nhs, JsonRpcStore, DataGrid) {

            // grid layout
            layout = [{
                cells: [
                    { field: 'name', name: 'Name', datatype: 'string', width: 50, editable: false }
                ]
            }];
            // grid plugins
            plugins = {
                indirectSelection: true,
                pagination: {
                    pageSizeArr: ['10', '25', '50', '100', 'All'],
                    description: '30%',
                    sizeSwitch: '260px',
                    pageStepper: '30em',
                    gotoButton: true,
                    maxPageStep: 5,
                    position: 'bottom'
                }
            };
            // grid
            var grid;

            ready(function() {


                // grid
                grid = new DataGrid({
                    id: 'grid',
                    structure: layout,
                    plugins : plugins,
                    store: 'resources/artist.json'
                });
                dojo.byId('grid').appendChild(grid.domNode);

                /*var registry = nhs.get('jsonrpcstore.registry');
                registry.add({ url: 'chinook/service', target: 'artist' });
                var store = registry.get('chinook/service/artist');
                store.fetch({
                    query: { id: '*' }
                });*/

                // create JSON-RPC services
                /*var artistService = new Service('chinook/service/artist');
                var albumService = new Service('chinook/service/album');
                var trackService = new Service('chinook/service/track');

                var count = 1;
                var artistId = 87; // Guns N' Roses
                artistService.list().then(function(artists) {
                    albumService.list(artists[artistId].id).then(function(albums) {
                        for(var i in albums) {
                            var album = albums[i];
                            (function(album) { // this closure is requried to save a reference to the current album
                                trackService.list(album.id).then(function(tracks) {
                                    for(var j in tracks) {
                                        var track = tracks[j];
                                        console.log(
                                            count++, ' - ',
                                            artists[artistId].name, ' - ',
                                            album.title, ' - ',
                                            track.name
                                        );
                                    }
                                });
                            })(album); // end: closure
                        }
                    });
                });*/

            });
            nhs.ready(function() {
                grid.startup();
            }, 1000);

        });
    </script>
</head>
<body>
    <div id="container" class="container" data-dojo-type="nhs/BorderContainer" data-dojo-props="design:'headline',gutters:true,liveSplitters:false,persist:false">
        <div id="pane_top" class="pane-top" data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:'top'">
        </div>
        <div id="pane_center" class="pane-center" data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:'center'">

            <div id="grid"></div>

        </div>
        <div id="pane_bottom" class="pane-bottom" data-dojo-type="dijit/layout/ContentPane" data-dojo-props="region:'bottom'">
        </div>
    </div>
</body>
</html>
